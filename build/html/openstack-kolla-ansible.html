

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meta Information &mdash; CCI_TESTBED_DOCS 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/width.css?v=38369d6f" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >

          
          
          <a href="index.html">
            
              <img src="_static/xG-rev-4c-01.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ccixg.html">Overview to CCI xG testbed</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies.html"><strong>CCI xG Testbed User Policy</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">More about the Commonwealth Cyber Initiative (CCI) xG Testbed</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OpenSAS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Opensas.html">OpenSAS Architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OpenStack</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openstack.html">Launching OpenStack Instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="openstack.html#create-an-instance-with-usrp-access">Create an Instance with USRP Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="openstack.html#configure-the-usrp-network-interface-inside-the-instance">Configure the USRP Network Interface Inside the Instance</a></li>
<li class="toctree-l1"><a class="reference internal" href="openstack.html#create-openstack-network">Create OpenStack Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="openstack.html#verifying-security-groups-in-openstack">Verifying Security Groups in OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="openstack.html#creating-and-associating-a-floating-ip-in-openstack">Creating and Associating a Floating IP in OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="openstack.html#dashboard-instructions-for-compute-vm-access">Dashboard Instructions for Compute VM Access</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network Plan</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="net_plan_config.html">Adding a Cloud-Config Script to OpenStack Server(VM) Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="net_plan_config.html#finding-usrp-devices-with-uhd-find-devices">Finding USRP Devices with uhd_find_devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="net_plan_config.html#testing-srsepc-and-deploying-srsue">Testing srsEPC and Deploying srsUE</a></li>
<li class="toctree-l1"><a class="reference internal" href="net_plan_config.html#network-configuration-changes-using-netplan">Network Configuration Changes using Netplan</a></li>
<li class="toctree-l1"><a class="reference internal" href="net_plan_config.html#network-configuration-and-testing-with-netplan-and-srsran">Network Configuration and Testing with Netplan and srsRAN</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OTIC</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="otic_documents.html">Open Testing and Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="otic_documents.html#physical-layout-and-architecture-of-the-lab-s">Physical Layout and Architecture of the Lab(s)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">UHD Config</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uhd.html">UHD Installation Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">4G Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="4g_prerequisite.html">Installation Script Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">4G Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="4g-deployment.html">4G Deployment Experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="4g-deployment.html#running-the-experiment">Running the Experiment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">5G Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="5g-deployment.html">5G Deployment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Creek Testbed</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CREEK_TESTBED_SITE.html">CCI xG Testbed: Outdoor Experimentation and Testing Environment(CBRS Testbed Site)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ORAN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oran.html">ORAN (Open Radio Access Network)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Team</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="team_info.html">CCI xG Testbed Team Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="team_info.html#director">Director</a></li>
<li class="toctree-l1"><a class="reference internal" href="team_info.html#doctoral-student-phd"><strong>Doctoral Student(PhD)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="team_info.html#master-s-researchers">Master’s Researchers</a></li>
<li class="toctree-l1"><a class="reference internal" href="team_info.html#postdoc-researcher">Postdoc Researcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="team_info.html#interns"><strong>Interns</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="team_info.html#research-faculty"><strong>Research Faculty</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="team_info.html#alumni-and-former-students">Alumni and Former Students</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Research</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="research_area.html">Research Areas</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contact</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contact_us.html">Get in Touch with the CCI xG Testbed Team</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CCI_TESTBED_DOCS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Meta Information</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/openstack-kolla-ansible.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="meta-information">
<h1>Meta Information<a class="headerlink" href="#meta-information" title="Link to this heading"></a></h1>
<p>This tutorial is with OpenStack Yoga along with Ubuntu 20.04.</p>
</section>
<section id="maas-installation">
<h1>MAAS Installation<a class="headerlink" href="#maas-installation" title="Link to this heading"></a></h1>
<p><a class="reference external" href="https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/yoga/install-maas.html">Install MAAS</a></p>
<p>The reason we’re installing MAAS is because we need to control the machines remotely. MAAS allows IPMI control over the servers (power on/off) along with installing Ubuntu OS remotely while also setting up public keys which will ensure that we can ssh into the machines without much of a hassle.</p>
<p>I’m skipping over this for now since it’s very straightforward. Below are the notes that Adam created when he deployed MAAS. It should be the same. You can also follow the OpenStack tutorial mentioned above:</p>
<p><a class="reference external" href="https://www.notion.so/Adam-s-MAAS-Installation-Notes-6476de00fff14ba88c124daeb6546e10?pvs=21">Adam’s MAAS Installation Notes</a></p>
<p>It should be noted that ideally, we would want to implement OpenStack’s own BMaaS to manage the IPMI control. But, I felt that it was useful to have backend control of the machine outside of the OpenStack environment. But, moving forward, I think we can work on deploying this.</p>
</section>
<section id="ansible-installation">
<h1>Ansible Installation<a class="headerlink" href="#ansible-installation" title="Link to this heading"></a></h1>
<p>Ansible’s deployment node will be on the same node as where MAAS is deployed.</p>
<ul>
<li><p>Update the package index as below along with installing all the dependent packages:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>python3-dev<span class="w"> </span>libffi-dev<span class="w"> </span>gcc<span class="w"> </span>libssl-dev<span class="w"> </span>python3-venv
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Enter the virtual python environment. This is done so that you can avoid conflicting packages with the host packages and ansible will work correctly.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>/home/ccistack/venv
<span class="nb">source</span><span class="w"> </span>/home/ccistack/venv/bin/activate
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Install pip and ansible in succession. Since we are using a virtual environment, we don’t need to use sudo.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>pip
pip<span class="w"> </span>install<span class="w"> </span><span class="s1">&#39;ansible&gt;=4,&lt;6&#39;</span>
</pre></div>
</div>
<p>You need to make sure that the version of ansible installed is under 6 since kolla-ansible doesn’t support the later versions of ansible yet as of October 13, 2022.</p>
</div></blockquote>
</li>
<li><p>Install kolla-ansible with its dependencies using pip in development mode. This means that you need to install kolla-ansible from source. You need to do this because you need to modify the neutron configuration so that you can setup the ONOS router for this.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>--branch<span class="w"> </span>stable/yoga<span class="w"> </span>https://opendev.org/openstack/kolla-ansible
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Install the kolla-ansible local git:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>./kolla-ansible
</pre></div>
</div>
<p>You can make changes within this repo later on when you have to deploy ONOS.</p>
</div></blockquote>
</li>
<li><p>Create a kolla directory in <code class="docutils literal notranslate"><span class="pre">/etc/kolla</span></code> and move the configuration files over there:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/etc/kolla
sudo<span class="w"> </span>chown<span class="w"> </span><span class="nv">$USER</span>:<span class="nv">$USER</span><span class="w"> </span>/etc/kolla
sudo<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>~/kolla-ansible/kolla-ansible/etc/kolla/*<span class="w"> </span>/etc/kolla
sudo<span class="w"> </span>cp<span class="w"> </span>~/kolla-ansible/kolla-ansible/ansible/inventory/*<span class="w"> </span>/etc/kolla
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Install all the Ansible Galaxy dependencies which are required from the Yoga release onward:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kolla-ansible<span class="w"> </span>install-deps
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Generate the <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> script using the command below. This will contain all the configurations by default.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-config<span class="w"> </span>init<span class="w"> </span>--disabled<span class="w"> </span>-t<span class="w"> </span>all<span class="w"> </span>&gt;<span class="w"> </span>ansible.cfg
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> file as per the following below (just enable them in the config):</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>defaults<span class="o">]</span>
<span class="nv">host_key_checking</span><span class="o">=</span>False
<span class="nv">pipelining</span><span class="o">=</span>True
<span class="nv">forks</span><span class="o">=</span><span class="m">100</span>
</pre></div>
</div>
<p>These configurations are just related to checking the ansible configuration - not related to OpenStack. So don’t worry too much about other tuning parameters unless you’re looking to speed things up.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="setting-up-the-multi-node-configuration">
<h1>Setting up the multi-node configuration<a class="headerlink" href="#setting-up-the-multi-node-configuration" title="Link to this heading"></a></h1>
<ul>
<li><dl>
<dt>Setup the SSH key pairs across the nodes. To do this, you need to create public/private key pairs on the hosts and share the public key between the two.</dt><dd><ul>
<li><p>Public Key of the Controller Node:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh-rsa<span class="w"> </span>AAAAB3NzaC1yc2EAAAADAQABAAABgQDmD2kc87f7vVB8R+LWFOVSFP8BoYjoqTXgiwl/NSU2s7SaV2/lvt5hqS6wbfRAY17N3sNow17qF40gIPKPySp0SrgODAbOtjvDxAvND6vfXJGMgEoGftUd9y5Y965ZDZqssESiZoc597UhLvIv9EWF8xg5drc4rx9Zwploi3cmjRxCYaIT9D2nYuFxsmE3mCrt2oMZWHdmIX3H0rRv4IkcJJkUyaVJoryTONI5twHvXrWsy1s3fEECcHfbipPwSPB1xILF735Z0vvIkKllmFKTM3Rc2iBpkDeBKKqACqcnOPomSU6AzE7goLm2/s4jdsdmcolUn+wdZ1BKTDki0WLZMLzS6yPOaXyLIlAPO0pMVhb5BJ3trsFjCgQBkVQ5fIgsi0hrGjAcUv85hwaPCE1RLs8jKMG4JpH0kPm5nnnd0N+GgE1wm+Bny0tZy8tcMCh1EAzS+aj+yblSCxM9qQlO9/AcP5nLKBaCXYn9s/kcYWjYSpeldVFYVJCqA2iUBi8<span class="o">=</span><span class="w"> </span>ubuntu@node-0
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Public Key of the Compute Node:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh-rsa<span class="w"> </span>AAAAB3NzaC1yc2EAAAADAQABAAABgQC8SwfB8WQ/qZPLJ6o7uE6477aI5+NrXdiYIPH+T2745SDtAlKvjEhvlOIWPzlte92Ez7FKxbsfq6QaiDTsbHDFOT+z6cnW1W9DfPXiUPvlxax1vYybZSWGi0MKDResO0z6tXmf80Q2e9X7uR1PJUGkLKodwaYTvp+GYOfxDQe3aLQ2FrdVvwysuFtmjHpNL32zdkEo4qmy74ZNywXpTeaA07gRhNcwFkGypYl88HQ5/1C/vmhFq7G81OC0w5DWkYE4tqx6SPBrJXPM1LN6jotmwNEbnvHhhK2XRRjpk0I/friDjV+ID5oNJaw760lOuwOEPezUMA2YBt4+Jl2NzzSEAyu7n7PGyA+ZY2Uxgzw60thETELSWv0zUNDjXxeOCQXxtjFfc0oIOjburdZx8wIeIe6sDoWbF4KV4Fyy93M3e8CmexdrZ1r4UAegeFC/EmUUoZddaLRPyQWnGTAw2HZa4DCpLLKs7yjSfuOYZr/E5lueyaNYsK1hRBpdMcxLGg8<span class="o">=</span><span class="w"> </span>ubuntu@node-2
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p>Install the public keys by putting these public keys in the <code class="docutils literal notranslate"><span class="pre">~/.ssh/authorized_keys</span></code> folder of each node.</p>
<p>After this, restart the ssh daemon sessions using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>sshd.service
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p>Setup the Ethernet ports so that you can setup the data and management network. It should be noted that the data network connects only between the nodes and the management network also connects to the internet.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>vi<span class="w"> </span>/etc/netplan/50-cloud-init.yaml
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Sample Network Configuration:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>network:
<span class="w">    </span>ethernets:
<span class="w">        </span>eno1:
<span class="w">            </span>addresses:
<span class="w">            </span>-<span class="w"> </span><span class="m">10</span>.0.0.27/24
<span class="w">            </span>gateway4:<span class="w"> </span><span class="m">10</span>.0.0.1
<span class="w">            </span>match:
<span class="w">                </span>macaddress:<span class="w"> </span>0c:42:a1:e1:f9:38
<span class="w">            </span>mtu:<span class="w"> </span><span class="m">1500</span>
<span class="w">            </span>nameservers:
<span class="w">                </span>addresses:
<span class="w">                </span>-<span class="w"> </span><span class="m">10</span>.0.0.100
<span class="w">                </span>-<span class="w"> </span><span class="m">10</span>.0.0.1
<span class="w">                </span>search:
<span class="w">                </span>-<span class="w"> </span>maas
<span class="w">            </span>set-name:<span class="w"> </span>eno1
<span class="w">        </span>eno2:
<span class="w">            </span>match:
<span class="w">                </span>macaddress:<span class="w"> </span>0c:42:a1:e1:f9:39
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, TEAM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
         .wy-nav-content { max-width: none;}
  </style>



</body>
</html>